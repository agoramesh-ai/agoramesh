# AgoraMesh Node Configuration
# Environment-specific settings
apiVersion: v1
kind: ConfigMap
metadata:
  name: agoramesh-node-config
  namespace: agoramesh
  labels:
    app.kubernetes.io/name: agoramesh-node
    app.kubernetes.io/component: config
data:
  # Logging configuration
  RUST_LOG: "info,agoramesh_node=debug"

  # Network configuration
  AGORAMESH_NETWORK: "mainnet"

  # API configuration
  AGORAMESH_API_LISTEN: "0.0.0.0:8080"
  AGORAMESH_CORS_ENABLED: "true"
  AGORAMESH_CORS_ORIGINS: "https://agoramesh.io"  # TODO: Set to actual production domain

  # P2P configuration
  AGORAMESH_P2P_LISTEN: "/ip4/0.0.0.0/tcp/4001"
  AGORAMESH_P2P_BOOTSTRAP: ""  # Comma-separated bootstrap peer addresses

  # Rate limiting
  AGORAMESH_RATE_LIMIT_ENABLED: "true"
  AGORAMESH_RATE_LIMIT_RPS: "100"
  AGORAMESH_RATE_LIMIT_BURST: "200"

  # Trust cache
  AGORAMESH_TRUST_CACHE_ENABLED: "true"
  AGORAMESH_TRUST_CACHE_TTL_SECS: "300"
  AGORAMESH_TRUST_CACHE_MAX_ENTRIES: "10000"

  # Metrics
  AGORAMESH_METRICS_ENABLED: "true"

  # Chain configuration (Base Mainnet)
  AGORAMESH_CHAIN_RPC: "https://mainnet.base.org"
  AGORAMESH_CHAIN_ID: "8453"

  # Contract addresses (to be filled after deployment)
  # AGORAMESH_TRUST_REGISTRY_ADDRESS: ""
  # AGORAMESH_ESCROW_ADDRESS: ""
---
# Testnet configuration variant
apiVersion: v1
kind: ConfigMap
metadata:
  name: agoramesh-node-config-testnet
  namespace: agoramesh
  labels:
    app.kubernetes.io/name: agoramesh-node
    app.kubernetes.io/component: config
    environment: testnet
data:
  RUST_LOG: "debug,agoramesh_node=trace"
  AGORAMESH_NETWORK: "testnet"
  AGORAMESH_API_LISTEN: "0.0.0.0:8080"
  AGORAMESH_CORS_ENABLED: "true"
  AGORAMESH_CORS_ORIGINS: "https://agoramesh.io"  # TODO: Set to actual production domain
  AGORAMESH_P2P_LISTEN: "/ip4/0.0.0.0/tcp/4001"
  AGORAMESH_RATE_LIMIT_ENABLED: "true"
  AGORAMESH_RATE_LIMIT_RPS: "50"
  AGORAMESH_RATE_LIMIT_BURST: "100"
  AGORAMESH_TRUST_CACHE_ENABLED: "true"
  AGORAMESH_TRUST_CACHE_TTL_SECS: "60"
  AGORAMESH_METRICS_ENABLED: "true"
  AGORAMESH_CHAIN_RPC: "https://sepolia.base.org"
  AGORAMESH_CHAIN_ID: "84532"
